{
    "DAU (R1)": "SELECT \n    metrics_date as \"time\", sum(CAST(metrics->'ActiveUser'->'uu'->>'uu' AS DOUBLE PRECISION)) as \"DAU (R1)\"\nFROM sapphire.sapphire_engagement_metrics_master\nWHERE \n           metrics_date >= '$start_date' -- Adjust the start date as needed\n    AND metrics_date <= '$end_date' -- Adjust the end date as needed\nAND application_id IN ('2130688B018F4B44BBED68E7A42BBA1E',\n        'AE427635ADC245AE973038BCB3D7C21B',\n        '4DC5714ABCAD449BA13A9B701A3CF296',\n        '4A5B528B59954AAE8725B509A41FBF1A',\n        'F185A93DE6764B098D55089F610A3FB8',\n        'FC320C411FC12CD4DFBE9A00F3161364')\n      AND period = 1\n      AND market = '#Overall#'\n      AND os_version = '#Overall#'\n      AND device_model = '#Overall#'\n      AND client_version = '#Overall#'\n      AND client_build_type = '#Overall#'\n      AND install_channel_l1 = '#Overall#'\n      AND install_channel_l2 = '#Overall#'\n      AND install_channel_l3 = '#Overall#'\n      AND install_channel_l4 = '#Overall#'\n      AND mini_app = ''\n      AND first_launch_source = '#Overall#'\n      AND launch_source = '#Overall#'\n    GROUP BY metrics_date\n",
    "DAU (R7)": "select metrics_date as \"time\", AVG(\"DAU\") OVER (ORDER BY metrics_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS \"DAU (R7)\"\nfrom \n(\nSELECT \n    metrics_date, SUM(CAST(metrics->'ActiveUser'->'uu'->>'uu' AS DOUBLE PRECISION)) as \"DAU\"\nFROM sapphire.sapphire_engagement_metrics_master\nWHERE metrics_date >= to_char(cast(cast('$start_date' as timestamp) + '- 7 DAY' as date), 'yyyy-mm-dd')::TEXT AND metrics_date <= '$end_date'\n      AND application_id IN ('2130688B018F4B44BBED68E7A42BBA1E',\n        'AE427635ADC245AE973038BCB3D7C21B',\n        '4DC5714ABCAD449BA13A9B701A3CF296',\n        '4A5B528B59954AAE8725B509A41FBF1A',\n        'F185A93DE6764B098D55089F610A3FB8',\n        'FC320C411FC12CD4DFBE9A00F3161364')\n      AND period = 1\n      AND market = '#Overall#'\n      AND os_version = '#Overall#'\n      AND device_model = '#Overall#'\n      AND client_version = '#Overall#'\n      AND client_build_type = '#Overall#'\n      AND install_channel_l1 = '#Overall#'\n      AND install_channel_l2 = '#Overall#'\n      AND install_channel_l3 = '#Overall#'\n      AND install_channel_l4 = '#Overall#'\n      AND mini_app = ''\n      AND first_launch_source = '#Overall#'\n      AND launch_source = '#Overall#'\n    GROUP BY metrics_date\n\n) t \n\n",
    "User Retention 7d - all markets": "select metrics_date as time, sum(cast(device_retention_rate_new_daily->>'return_count' as DOUBLE PRECISION)) / sum(cast(device_retention_rate_new_daily->>'dau' as DOUBLE PRECISION)) as \"Retention D7 R1\"\nfrom sapphire.sapphire_retention_master\nwhere \n           metrics_date >= '$start_date' -- Adjust the start date as needed\n    AND metrics_date <= '$end_date' -- Adjust the end date as needed\nand offset_day = 7\nand application_id in ('2130688B018F4B44BBED68E7A42BBA1E',\n        'AE427635ADC245AE973038BCB3D7C21B',\n        '4DC5714ABCAD449BA13A9B701A3CF296',\n        '4A5B528B59954AAE8725B509A41FBF1A',\n        'F185A93DE6764B098D55089F610A3FB8',\n        'FC320C411FC12CD4DFBE9A00F3161364')\nand market = '#Overall#'\nand clientversion = '#Overall#'\nand install_source in ('Organic', 'FirstParty', 'RewardsUpsell', 'PaidAds', 'Google Ads ACI', 'Upsell')\nand osversion = '#Overall#'\nand build = '#Overall#'\nand mini_app = ''\nand launch_source = '#Overall#'\nand device_model = '#Overall#'\ngroup by metrics_date",
    "User Retention 7d rolling avg - all markets": "SELECT\n    metrics_date AS \"time\", AVG(a.\"RetentionRate_7D\") OVER (ORDER BY metrics_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS \"Retention D7 R7\"\nFROM(\n    SELECT \n        metrics_date, sum(cast(device_retention_rate_new_daily->>'return_count' as DOUBLE PRECISION)) / sum(cast(device_retention_rate_new_daily->>'dau' as DOUBLE PRECISION)) as \"RetentionRate_7D\"\n    from sapphire.sapphire_retention_master\n    where metrics_date >= cast(cast('$start_date' as timestamp) + '- 7 DAY' as TEXT) AND metrics_date <= cast('$end_date' as TEXT)\n        and offset_day = 7\n        and application_id in ('2130688B018F4B44BBED68E7A42BBA1E',\n        'AE427635ADC245AE973038BCB3D7C21B',\n        '4DC5714ABCAD449BA13A9B701A3CF296',\n        '4A5B528B59954AAE8725B509A41FBF1A',\n        'F185A93DE6764B098D55089F610A3FB8',\n        'FC320C411FC12CD4DFBE9A00F3161364')\n        and market = '#Overall#'\n        and clientversion = '#Overall#'\n        and install_source in ('Organic', 'FirstParty', 'RewardsUpsell', 'PaidAds', 'Google Ads ACI', 'Upsell')\n        and osversion = '#Overall#'\n        and build = '#Overall#'\n        and mini_app = ''\n        and launch_source = '#Overall#'\n        and device_model = '#Overall#'\n    group by metrics_date\n) a",
    "Chat Active DAU (R1)": "SELECT \n\tmetrics_date AS \"time\",\n        SUM(CAST(metrics->'ActiveUser'->'dau'->'chat_active_dau' AS DOUBLE PRECISION)) AS \"Chat Active DAU (R1)\"\nFROM codex_metrics.codex_engagement_metrics_master\nWHERE metrics_date >= to_char(cast(cast('$start_date' as timestamp) + '- 7 DAY' as date), 'yyyy-mm-dd')::TEXT \n  AND metrics_date <= '$end_date'\n  AND application_id in ('2130688B018F4B44BBED68E7A42BBA1E',\n        'AE427635ADC245AE973038BCB3D7C21B',\n        '4DC5714ABCAD449BA13A9B701A3CF296',\n        '4A5B528B59954AAE8725B509A41FBF1A',\n        'F185A93DE6764B098D55089F610A3FB8',\n        'FC320C411FC12CD4DFBE9A00F3161364')\n\tAND id_type= 'reportable_id'\n  AND market ='#Overall#'\n  AND install_channel_l1 ='#Overall#'\n  AND install_channel_l2 ='#Overall#'\n\tAND first_launch_entry_point ='#Overall#'\n\tAND period = 1\n\tAND os_version ='#Overall#'\n\tAND device_model ='#Overall#'\n\tAND client_version ='#Overall#'\n\tAND client_build_type ='#Overall#'\n\tAND install_channel_l3 ='#Overall#'\n\tAND install_channel_l4 ='#Overall#'\n\tAND mini_app ='#Overall#'\n\tAND first_launch_source ='#Overall#'\nGROUP BY metrics_date\nORDER BY metrics_date",
    "Chat Active DAU (R7)": "select  metrics_date as \"time\", AVG(\"Chat_Active_DAU\") OVER (ORDER BY metrics_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS \"Chat Active DAU (R7)\"\nfrom (\nSELECT \n  metrics_date,\n  SUM(CAST(metrics->'ActiveUser'->'dau'->'chat_active_dau' AS DOUBLE PRECISION)) AS \"Chat_Active_DAU\"\nFROM codex_metrics.codex_engagement_metrics_master\nWHERE metrics_date >= to_char(cast(cast('$start_date' as timestamp) + '- 7 DAY' as date), 'yyyy-mm-dd')::TEXT \n  AND metrics_date <= '$end_date'\n  AND application_id in ('2130688B018F4B44BBED68E7A42BBA1E',\n        'AE427635ADC245AE973038BCB3D7C21B',\n        '4DC5714ABCAD449BA13A9B701A3CF296',\n        '4A5B528B59954AAE8725B509A41FBF1A',\n        'F185A93DE6764B098D55089F610A3FB8',\n        'FC320C411FC12CD4DFBE9A00F3161364')\n\tAND id_type= 'reportable_id'\n  AND market ='#Overall#'\n  AND install_channel_l1 ='#Overall#'\n  AND install_channel_l2 ='#Overall#'\n\tAND first_launch_entry_point ='#Overall#'\n\tAND period = 1\n\tAND os_version ='#Overall#'\n\tAND device_model ='#Overall#'\n\tAND client_version ='#Overall#'\n\tAND client_build_type ='#Overall#'\n\tAND install_channel_l3 ='#Overall#'\n\tAND install_channel_l4 ='#Overall#'\n\tAND mini_app ='#Overall#'\n\tAND first_launch_source ='#Overall#'\nGROUP BY metrics_date\n) t\n"
}